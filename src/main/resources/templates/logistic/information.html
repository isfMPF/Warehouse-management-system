<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header.html :: headerfiles(pageTitle='Заказы')}"></head>
<body>
<div th:replace="~{fragments/header.html :: header}"></div>

<div class="d-flex justify-content-center align-items-center mt-5">
    <div class="card" style="width: 100%; max-width: 1200px;">
        <div class="card-header">
        </div>
        <div class="card-body">
            <form action="/logistics/export" method="post">
                <div th:each="order : ${orders}">
                    <!-- Шапка заказа -->
                    <div class="order-header">
                        <div class="order-title">Заказ #<span th:text="${order.id}"></span></div>
                        <input class="form-check-input" type="hidden" th:value="${order.id}" th:checked="true"
                               name="selectedOrderIds" />
                        <div class="order-details">
                            <span class="order-detail">Дата: <span th:text="${#temporals.format(order.date, 'dd.MM.yyyy')}"></span></span>
                            <span class="order-detail">Клиент: <span th:text="${order.clientName}"></span></span>
                            <span class="order-detail">Код клиента: <span th:text="${order.codeClient}"></span></span>
                            <span class="order-detail">Общая сумма: <span th:text="${order.total} + ' ₽'"></span></span>
                            <span class="order-detail">Общий вес:
                            <span th:text="${#aggregates.sum(order.item.?[weight != null].![amount * weight])} + ' кг'"></span></span>
                            <span class="order-detail">Общее количество товара:
                                <span th:text="${ #aggregates.sum(order.item.?[amount != null].![amount])} + ' шт'"></span></span>
                        </div>
                    </div>

                    <div class="table-responsive"> <!-- Таблица товаров -->
                        <table class="items-table">
                            <thead>
                            <tr>
                                <th>Код</th>
                                <th>Наименование</th>
                                <th>Объем</th>
                                <th>Кол-во</th>
                                <th>Цена</th>
                                <th>Сумма</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="item : ${order.item}">
                                <td th:text="${item.code}"></td>
                                <td th:text="${item.name}"></td>
                                <td th:text="${item.volume}"></td>
                                <td th:text="${item.amount}"></td>
                                <td th:text="${item.price} + ' ₽'"></td>
                                <td th:text="${item.total} + ' ₽'"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Разделитель между заказами -->
                    <div class="order-separator"></div>
                </div>
                <button class="btn btn-success" type="submit">Экспортировать</button>
                <input type="button" value="Назад" class="btn btn-primary" onclick="history.back();">
            </form>
        </div>

    </div>

</div>
</body>
</html>
